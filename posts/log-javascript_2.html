---
layout: post
title: javaScript 学習履歴(async/await fetch)
excerpt: javaScript、学習したこと(async/await fetch)
date: 2020-08-28
tags: log, javascript
author: sasami
---

##JavaScriptのオブジェクトのキーに変数の値を使う
JavaScriptのオブジェクトのプロパティにアクセスする方法には、ドット演算子とブラケット演算子の2つがあります。
---------------------------------------------
■ドット演算子
var user = { 'name':'Jonh', 'age':24, 'gender':'male'};
var userName = user.name;

■ブラケット演算子
var user = { 'name':'Jonh', 'age':24, 'gender':'male'};
var userName = user['name'];
---------------------------------------------

この、プリパティの指定を変数を使って行いたい場合には、ブラケット演算子を使用します。
---------------------------------------------
var user = { 'name':'Jonh', 'age':24, 'gender':'male'};
var plopaty = 'name';

var userName = user.plopaty; ←×エラー
var userName = user[plopaty]; ←〇値を取得できる
---------------------------------------------
【JavaScriptのオブジェクトのキーに変数の値を使うTips】
https://qiita.com/masarufuruya/items/d29a567d0ca4bbfb00cb


■論理和 (||) 演算子
https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Operators/Logical_OR
--------------------
１）Orとして使う。
if(a === 1 || b === 1){
  //処理
}
--------------------
２)構文として使う
>expr1 || expr2
expr1 が true に変換できる場合は expr1 を返し、それ以外の場合は expr2 を返します。

false に変換されうる式の例を示します。
>null、NaN、0、空文字列 ("" または '' または ``)、undefined

例）
>var text = "あいうえおあいうえお" ;
>var targetStr = "あ" ;
>var count = ( text.match( new RegExp( targetStr, "g" ) ) || [] ).length ;
文字列textに、文字targetStrが含まれていた場合はその文字を抽出して配列で返し、
文字列textに、文字targetStrが含まれていない場合（null）は空の配列（[]）を返す。

※【text.match(new RegExp(targetStr,"g"))||[]】を囲う()は、即時関数なのか？

https://qiita.com/katsukii/items/cfe9fd968ba0db603b1e
https://wp-p.info/tpl_rep.php?cat=js-intermediate&fl=r11
https://wp-p.info/tpl_rep.php?cat=js-intermediate&fl=r10
https://wp-p.info/tpl_rep.php?cat=js-intermediate&fl=r9
https://qiita.com/ukiuni@github/items/5f3d8620187905aea3d4#8-function%E5%89%8D%E3%81%AE%E5%A4%89%E3%81%AA%E8%A8%98%E5%8F%B7
--------------------


##fetchでDOG APIで犬の画像を取得して表示してみた
(Udemy:JavaScriptをとことんやってみよう: 67. fetch その1～  69. fetch その3)
■HTML
---------------------------------------------
<div id="dog" class="w300"></div>	
<div id="cat" class="w300"></div>
<div id="fox" class="w300"></div>
---------------------------------------------

■javaScript
---------------------------------------------
"use strict";

const dogUrl = 'https://dog.ceo/api/breeds/image/random';
const catUrl = 'https://aws.random.cat/meow';
const foxUrl = 'https://randomfox.ca/floof';

const options = {
	method: 'GET'
};

function fetchImage(url, options){
	return fetch(url, options)
		.then(response => {
			console.log(response);
			console.log(response.ok);
			console.log(response.status);
			if(response.ok){
				return response.json();
			}
			throw new Error('エラーです');
		
		}).catch(e => {
			console.log(e.message);
		});
}

async function getImage(url, options, id, key){
	const response = await fetchImage(url ,options);
	const imageDiv = document.getElementById(id);
	const imageElement = document.createElement('img');
	if(response){
		console.log(response);
		imageElement.src = response[key];
	} else {
		imageElement.src = 'img/err.jpg';
	}
	imageDiv.appendChild(imageElement);
}

getImage(dogUrl, options, 'dog', 'message');
getImage(catUrl, options, 'cat', 'file');
getImage(foxUrl, options, 'fox', 'image');
---------------------------------------------
